/cvmfs/sft.cern.ch/lcg/views/LCG_103_LHCB_7/x86_64-centos7-clang12-opt/lib/python3.9/site-packages/numpy/core/getlimits.py:499: UserWarning: The value of the smallest subnormal for <class 'numpy.float32'> type is zero.
  setattr(self, word, getattr(machar, word).flat[0])
/cvmfs/sft.cern.ch/lcg/views/LCG_103_LHCB_7/x86_64-centos7-clang12-opt/lib/python3.9/site-packages/numpy/core/getlimits.py:89: UserWarning: The value of the smallest subnormal for <class 'numpy.float32'> type is zero.
  return self._float_to_str(self.smallest_subnormal)
/cvmfs/sft.cern.ch/lcg/views/LCG_103_LHCB_7/x86_64-centos7-clang12-opt/lib/python3.9/site-packages/numpy/core/getlimits.py:499: UserWarning: The value of the smallest subnormal for <class 'numpy.float64'> type is zero.
  setattr(self, word, getattr(machar, word).flat[0])
/cvmfs/sft.cern.ch/lcg/views/LCG_103_LHCB_7/x86_64-centos7-clang12-opt/lib/python3.9/site-packages/numpy/core/getlimits.py:89: UserWarning: The value of the smallest subnormal for <class 'numpy.float64'> type is zero.
  return self._float_to_str(self.smallest_subnormal)
/uscms_data/d3/sundberg/BBto2b4tau/Topographs_Ethan/functions/tools.py:365: RuntimeWarning: divide by zero encountered in log
  self.momentum[..., 3] = np.log(self.momentum[..., 3])
/uscms_data/d3/sundberg/BBto2b4tau/Topographs_Ethan/functions/tools.py:365: RuntimeWarning: divide by zero encountered in log
  self.momentum[..., 3] = np.log(self.momentum[..., 3])
2025-06-30 11:28:44.964277: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-06-30 11:28:45.031436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 11430 MB memory:  -> device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:65:00.0, compute capability: 6.0
Model: "topograph_model"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 create_mask (CreateMask)    multiple                  0         
                                                                 
 graph_block (GraphBlock)    multiple                  189089    
                                                                 
 graph_block_1 (GraphBlock)  multiple                  238177    
                                                                 
 initialize_helper_nodes_w (  multiple                 6594      
 InitializeHelperNodesW)                                         
                                                                 
 particle_prediction_ml_ps (  multiple                 17542     
 ParticlePredictionMLPs)                                         
                                                                 
 initialize_helper_nodes_top  multiple                 6594      
 _fixed (InitializeHelperNod                                     
 esTopFixed)                                                     
                                                                 
 particle_prediction_ml_ps_1  multiple                 25734     
  (ParticlePredictionMLPs)                                       
                                                                 
 topo_graph_block (TopoGraph  multiple                 1478387   
 Block)                                                          
                                                                 
 topo_graph_block_1 (TopoGra  multiple                 1517299   
 phBlock)                                                        
                                                                 
 topo_graph_block_2 (TopoGra  multiple                 1517299   
 phBlock)                                                        
                                                                 
 topo_graph_block_3 (TopoGra  multiple                 1517299   
 phBlock)                                                        
                                                                 
=================================================================
Total params: 6,514,034
Trainable params: 6,514,014
Non-trainable params: 20
_________________________________________________________________
None

Start epoch 1/100
2025-06-30 11:30:55.345692: I tensorflow/stream_executor/cuda/cuda_dnn.cc:368] Loaded cuDNN version 8800
loss: 9.6545, Initialisation: 1.3984, Regression_0: 1.3166, Regression_1: 1.2216, Regression_2: 1.1227, Regression_3: 1.0910, Classification_0: 1.0099, Classification_1: 0.8932, Classification_2: 0.8128, Classification_3: 0.7883, 
loss: 8.3662, Initialisation: 1.2506, Regression_0: 1.1649, Regression_1: 1.0657, Regression_2: 0.9259, Regression_3: 0.8655, Classification_0: 0.9288, Classification_1: 0.7905, Classification_2: 0.6991, Classification_3: 0.6751, 
Val loss improved from inf to 8.37,saving weights to log_dir/model_01-8.37.h5
Time taken: 1731.62s

Start epoch 2/100
loss: 7.5782, Initialisation: 1.1847, Regression_0: 1.0841, Regression_1: 0.9544, Regression_2: 0.7993, Regression_3: 0.7371, Classification_0: 0.8673, Classification_1: 0.7112, Classification_2: 0.6309, Classification_3: 0.6091, 
loss: 7.1444, Initialisation: 1.1202, Regression_0: 1.0289, Regression_1: 0.8974, Regression_2: 0.7360, Regression_3: 0.6713, Classification_0: 0.8341, Classification_1: 0.6767, Classification_2: 0.6002, Classification_3: 0.5795, 
Val loss improved from 8.37 to 7.14,saving weights to log_dir/model_02-7.14.h5
Time taken: 1492.83s

Start epoch 3/100
loss: 8.4080, Initialisation: 1.3078, Regression_0: 1.1686, Regression_1: 1.0662, Regression_2: 0.9272, Regression_3: 0.8749, Classification_0: 0.9240, Classification_1: 0.7779, Classification_2: 0.6925, Classification_3: 0.6689, 
loss: 7.6404, Initialisation: 1.2138, Regression_0: 1.0782, Regression_1: 0.9671, Regression_2: 0.8095, Regression_3: 0.7539, Classification_0: 0.8682, Classification_1: 0.7125, Classification_2: 0.6301, Classification_3: 0.6071, 
Time taken: 1484.86s

Start epoch 4/100
loss: 7.1820, Initialisation: 1.1363, Regression_0: 1.0146, Regression_1: 0.9029, Regression_2: 0.7510, Regression_3: 0.6893, Classification_0: 0.8276, Classification_1: 0.6775, Classification_2: 0.6014, Classification_3: 0.5814, 
loss: 6.9038, Initialisation: 1.0940, Regression_0: 0.9794, Regression_1: 0.8670, Regression_2: 0.7099, Regression_3: 0.6476, Classification_0: 0.8073, Classification_1: 0.6551, Classification_2: 0.5812, Classification_3: 0.5624, 
Val loss improved from 7.14 to 6.90,saving weights to log_dir/model_04-6.90.h5
Time taken: 1486.81s

Start epoch 5/100
loss: 7.9282, Initialisation: 1.2540, Regression_0: 1.0990, Regression_1: 0.9967, Regression_2: 0.8638, Regression_3: 0.8066, Classification_0: 0.8800, Classification_1: 0.7401, Classification_2: 0.6556, Classification_3: 0.6324, 
loss: 7.3194, Initialisation: 1.1439, Regression_0: 1.0110, Regression_1: 0.9112, Regression_2: 0.7897, Regression_3: 0.7260, Classification_0: 0.8298, Classification_1: 0.6956, Classification_2: 0.6154, Classification_3: 0.5966, 
Time taken: 1486.10s

Start epoch 6/100
loss: 7.1359, Initialisation: 1.1621, Regression_0: 1.0045, Regression_1: 0.8891, Regression_2: 0.7426, Regression_3: 0.6809, Classification_0: 0.8152, Classification_1: 0.6705, Classification_2: 0.5951, Classification_3: 0.5758, 
loss: 6.8296, Initialisation: 1.1076, Regression_0: 0.9635, Regression_1: 0.8499, Regression_2: 0.7021, Regression_3: 0.6401, Classification_0: 0.7901, Classification_1: 0.6467, Classification_2: 0.5736, Classification_3: 0.5560, 
Val loss improved from 6.90 to 6.83,saving weights to log_dir/model_06-6.83.h5
Time taken: 1488.06s

Start epoch 7/100
loss: 8.1368, Initialisation: 1.3182, Regression_0: 1.1169, Regression_1: 1.0065, Regression_2: 0.8888, Regression_3: 0.8225, Classification_0: 0.8931, Classification_1: 0.7662, Classification_2: 0.6747, Classification_3: 0.6500, 
loss: 7.6294, Initialisation: 1.2073, Regression_0: 1.0351, Regression_1: 0.9332, Regression_2: 0.8345, Regression_3: 0.7446, Classification_0: 0.8576, Classification_1: 0.7591, Classification_2: 0.6446, Classification_3: 0.6133, 
Time taken: 1487.47s

Start epoch 8/100
loss: 7.2092, Initialisation: 1.1496, Regression_0: 0.9888, Regression_1: 0.8862, Regression_2: 0.7749, Regression_3: 0.6952, Classification_0: 0.8164, Classification_1: 0.7039, Classification_2: 0.6087, Classification_3: 0.5854, 
loss: 6.9077, Initialisation: 1.1065, Regression_0: 0.9567, Regression_1: 0.8502, Regression_2: 0.7268, Regression_3: 0.6522, Classification_0: 0.7935, Classification_1: 0.6737, Classification_2: 0.5847, Classification_3: 0.5635, 
Time taken: 1557.52s

Start epoch 9/100
loss: 7.3555, Initialisation: 1.1727, Regression_0: 1.0119, Regression_1: 0.9079, Regression_2: 0.7922, Regression_3: 0.7343, Classification_0: 0.8194, Classification_1: 0.6985, Classification_2: 0.6198, Classification_3: 0.5988, 
loss: 6.9830, Initialisation: 1.1237, Regression_0: 0.9678, Regression_1: 0.8602, Regression_2: 0.7376, Regression_3: 0.6790, Classification_0: 0.7877, Classification_1: 0.6671, Classification_2: 0.5901, Classification_3: 0.5699, 
Time taken: 1487.73s

Start epoch 10/100
loss: 6.7649, Initialisation: 1.1026, Regression_0: 0.9412, Regression_1: 0.8278, Regression_2: 0.7054, Regression_3: 0.6472, Classification_0: 0.7682, Classification_1: 0.6447, Classification_2: 0.5731, Classification_3: 0.5545, 
loss: 6.5908, Initialisation: 1.0713, Regression_0: 0.9177, Regression_1: 0.8046, Regression_2: 0.6803, Regression_3: 0.6230, Classification_0: 0.7554, Classification_1: 0.6308, Classification_2: 0.5623, Classification_3: 0.5454, 
Val loss improved from 6.83 to 6.59,saving weights to log_dir/model_10-6.59.h5
Time taken: 1553.05s
